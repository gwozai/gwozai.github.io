<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>高级弹幕墙</title><script src="https://cdn.tailwindcss.com"></script><script>tailwind.config={theme:{extend:{fontFamily:{sans:['Noto Sans SC','system-ui','sans-serif']},}}}</script><style>@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap');:root{--primary-color:#4f46e5;--secondary-color:#10b981;--accent-color:#0ea5e9;--bg-color:#0f172a;--text-color:#f8fafc;--panel-bg:rgba(15,23,42,0.8)}body{overflow:hidden;background-color:var(--bg-color);margin:0;padding:0;font-family:'Noto Sans SC',sans-serif;color:var(--text-color)}.danmu-container{position:relative;height:100vh;width:100vw;overflow:hidden;transition:background-color .5s ease}.danmu{position:absolute;white-space:nowrap;padding:4px 12px;border-radius:4px;box-shadow:0 2px 10px rgba(0,0,0,.15);will-change:transform;transition:opacity .3s ease;cursor:pointer}.danmu:hover{filter:brightness(1.2);transform:scale(1.05)!important;z-index:10}.control-panel{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);z-index:100;display:flex;gap:10px;background:var(--panel-bg);backdrop-filter:blur(10px);padding:12px 20px;border-radius:50px;box-shadow:0 4px 20px rgba(0,0,0,.3);border:1px solid rgba(255,255,255,.1);transition:all .3s ease}.control-btn{display:flex;align-items:center;justify-content:center;border-radius:50px;transition:all .3s ease;position:relative;overflow:hidden}.control-btn::before{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(255,255,255,.1);transform:translateY(100%);transition:transform .3s ease}.control-btn:hover::before{transform:translateY(0)}.settings-panel{position:fixed;bottom:90px;left:50%;transform:translateX(-50%) translateY(20px);z-index:99;background:var(--panel-bg);backdrop-filter:blur(10px);padding:20px;border-radius:16px;box-shadow:0 4px 30px rgba(0,0,0,.3);border:1px solid rgba(255,255,255,.1);width:300px;max-width:90vw;opacity:0;pointer-events:none;transition:all .3s ease}.settings-panel.active{opacity:1;pointer-events:auto;transform:translateX(-50%) translateY(0)}.slider-container{margin:15px 0}.slider-label{display:flex;justify-content:space-between;margin-bottom:5px}.slider{width:100%;height:5px;-webkit-appearance:none;appearance:none;background:rgba(255,255,255,.2);border-radius:5px;outline:none}.slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:15px;height:15px;border-radius:50%;background:var(--primary-color);cursor:pointer;transition:all .2s ease}.slider::-webkit-slider-thumb:hover{transform:scale(1.2)}.theme-selector{display:flex;gap:10px;margin:15px 0;justify-content:center}.theme-option{width:30px;height:30px;border-radius:50%;cursor:pointer;border:2px solid transparent;transition:all .2s ease}.theme-option.active{border-color:white;transform:scale(1.1)}.fullscreen .control-panel{opacity:0}.fullscreen .control-panel:hover{opacity:1}.fullscreen-icon,.exit-fullscreen-icon{transition:all .3s ease}.fullscreen .fullscreen-icon{display:none}.fullscreen .exit-fullscreen-icon{display:block}.exit-fullscreen-icon{display:none}.loader{position:fixed;top:0;left:0;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;background:var(--bg-color);z-index:1000;transition:opacity .5s ease,visibility .5s ease}.loader.hidden{opacity:0;visibility:hidden}.loader-spinner{width:50px;height:50px;border:5px solid rgba(255,255,255,.1);border-radius:50%;border-top-color:var(--primary-color);animation:spin 1s ease-in-out infinite}.danmu-click-effect{position:absolute;border-radius:50%;pointer-events:none;background:radial-gradient(circle,rgba(255,255,255,.8) 0%,rgba(255,255,255,0) 70%);animation:ripple .8s ease-out;z-index:5}.toast{position:fixed;top:20px;left:50%;transform:translateX(-50%);background:var(--panel-bg);color:var(--text-color);padding:10px 20px;border-radius:50px;box-shadow:0 4px 20px rgba(0,0,0,.3);backdrop-filter:blur(10px);z-index:1000;opacity:0;transition:opacity .3s ease}.toast.show{opacity:1}@keyframes spin{to{transform:rotate(360deg)}}@keyframes ripple{from{opacity:1;transform:scale(0)}to{opacity:0;transform:scale(2)}}@media (max-width:640px){.control-panel{padding:8px 12px;gap:5px}.control-btn{padding:6px 10px;font-size:.875rem}.btn-icon{width:1rem;height:1rem}.settings-panel{width:85vw;padding:15px}}.theme-dark{--bg-color:#0f172a;--panel-bg:rgba(15,23,42,0.8)}.theme-light{--bg-color:#f1f5f9;--panel-bg:rgba(241,245,249,0.8);--text-color:#1e293b}.theme-neon{--bg-color:#000000;--panel-bg:rgba(0,0,0,0.8);--primary-color:#ff00ff;--secondary-color:#00ffff;--accent-color:#ffff00}.theme-sunset{--bg-color:#1a1a2e;--panel-bg:rgba(26,26,46,0.8);--primary-color:#ff6b6b;--secondary-color:#ffa502;--accent-color:#70a1ff}.danmu-effect-glow{text-shadow:0 0 5px currentColor}.danmu-effect-outline{text-shadow:-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000}.danmu-effect-3d{text-shadow:0 1px 0 #ccc,0 2px 0 #c9c9c9,0 3px 0 #bbb,0 4px 0 #b9b9b9,0 5px 0 #aaa}</style></head><body class="font-sans theme-dark"><div class="loader" id="loader"><div class="loader-spinner"></div></div><div class="danmu-container" id="danmu-container"></div><div id="toast" class="toast">已复制到剪贴板</div><div class="settings-panel" id="settings-panel"><h3 class="text-lg font-semibold mb-4 text-center">弹幕设置</h3><div class="slider-container"><div class="slider-label"><span>弹幕数量</span><span id="density-value">100</span></div><input type="range" min="20" max="200" value="100" class="slider" id="density-slider"></div><div class="slider-container"><div class="slider-label"><span>弹幕速度</span><span id="speed-value">中等</span></div><input type="range" min="1" max="5" value="3" class="slider" id="speed-slider"></div><div class="slider-container"><div class="slider-label"><span>字体大小</span><span id="size-value">中等</span></div><input type="range" min="1" max="5" value="3" class="slider" id="size-slider"></div><h4 class="text-md font-medium mt-4 mb-2 text-center">主题选择</h4><div class="theme-selector"><div class="theme-option active" data-theme="dark" style="background:#0f172a"></div><div class="theme-option" data-theme="light" style="background:#f1f5f9"></div><div class="theme-option" data-theme="neon" style="background:linear-gradient(45deg,#ff00ff,#00ffff)"></div><div class="theme-option" data-theme="sunset" style="background:linear-gradient(45deg,#ff6b6b,#ffa502)"></div></div><h4 class="text-md font-medium mt-4 mb-2 text-center">弹幕特效</h4><div class="flex justify-center gap-2 mb-4"><button id="effect-none" class="px-3 py-1 bg-gray-700 rounded-full text-sm active">无</button><button id="effect-glow" class="px-3 py-1 bg-gray-700 rounded-full text-sm">发光</button><button id="effect-outline" class="px-3 py-1 bg-gray-700 rounded-full text-sm">描边</button><button id="effect-3d" class="px-3 py-1 bg-gray-700 rounded-full text-sm">3D</button></div></div><div class="control-panel"><button id="refresh-btn" class="control-btn bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-4 sm:px-6 rounded-full transition-all duration-300 flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="btn-icon h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg><span class="hidden sm:inline">刷新</span></button><button id="add-btn" class="control-btn bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-2 px-4 sm:px-6 rounded-full transition-all duration-300 flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="btn-icon h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg><span class="hidden sm:inline">添加</span></button><button id="settings-btn" class="control-btn bg-amber-600 hover:bg-amber-700 text-white font-medium py-2 px-4 sm:px-6 rounded-full transition-all duration-300 flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="btn-icon h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg><span class="hidden sm:inline">设置</span></button><button id="fullscreen-btn" class="control-btn bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 sm:px-6 rounded-full transition-all duration-300 flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="fullscreen-icon btn-icon h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 4h-4m4 0l-5-5"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="exit-fullscreen-icon btn-icon h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg><span class="hidden sm:inline fullscreen-text">全屏</span><span class="hidden sm:inline exit-fullscreen-text" style="display:none">退出</span></button></div><script>const CONFIG={maxDanmu:100,spawnInterval:500,minSpeed:5,maxSpeed:15,minFontSize:14,maxFontSize:24,trackCount:20,colors:['bg-blue-500','bg-indigo-500','bg-purple-500','bg-pink-500','bg-red-500','bg-orange-500','bg-amber-500','bg-yellow-500','bg-lime-500','bg-green-500','bg-emerald-500','bg-teal-500','bg-cyan-500','bg-sky-500','bg-violet-500','bg-fuchsia-500'],opacities:['bg-opacity-80','bg-opacity-70','bg-opacity-90'],fontWeights:['font-normal','font-medium','font-semibold'],refreshInterval:30000,danmuEffect:''};let sentences=[],danmuCount=0,tracks=[],isFullscreen=!1,settingsOpen=!1,spawnIntervalId=null,autoRefreshId=null,currentTheme='dark';function getRandomItem(e){return e[Math.floor(Math.random()*e.length)]}function getRandomNumber(e,t){return Math.random()*(t-e)+e}function getRandomSentence(){return 0===sentences.length?"加载中...":sentences[Math.floor(Math.random()*sentences.length)]}function initTracks(){const e=document.getElementById("danmu-container"),t=e.clientHeight/CONFIG.trackCount;tracks=[];for(let e=0;e<CONFIG.trackCount;e++)tracks.push({y:e*t,height:t,danmus:[]})}function showToast(e){const t=document.getElementById("toast");t.textContent=e,t.classList.add("show"),setTimeout(()=>{t.classList.remove("show")},2000)}function copyToClipboard(e){if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(e).then(()=>{showToast("已复制到剪贴板")}).catch(e=>{console.error("复制失败:",e),showToast("复制失败")});{const t=document.createElement("textarea");t.value=e,t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select();try{document.execCommand("copy")?showToast("已复制到剪贴板"):showToast("复制失败")}catch(e){console.error("复制失败:",e),showToast("复制失败")}document.body.removeChild(t)}}function createDanmu(){if(danmuCount>=CONFIG.maxDanmu)return;const e=document.getElementById("danmu-container"),t=getRandomItem(tracks),n=document.createElement("div");n.className=`danmu ${getRandomItem(CONFIG.colors)} ${getRandomItem(CONFIG.opacities)} ${getRandomItem(CONFIG.fontWeights)} ${CONFIG.danmuEffect}`,n.textContent=getRandomSentence();const a=getRandomNumber(CONFIG.minFontSize,CONFIG.maxFontSize);n.style.fontSize=`${a}px`,n.style.top=`${t.y+(t.height-a)/2}px`,n.style.right=`-${n.textContent.length*a}px`,e.appendChild(n),t.danmus.push(n),danmuCount++;const o=getRandomNumber(CONFIG.minSpeed,CONFIG.maxSpeed),s=e.clientWidth+n.offsetWidth;n.style.transition=`transform ${o}s linear`,requestAnimationFrame(()=>{n.style.transform=`translateX(-${s}px)`}),n.addEventListener("transitionend",()=>{if(n.parentNode){n.parentNode.removeChild(n);const e=t.danmus.indexOf(n);e>-1&&t.danmus.splice(e,1),danmuCount--}}),n.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();const a=document.createElement("div");a.className="danmu-click-effect",a.style.left=`${t.clientX}px`,a.style.top=`${t.clientY}px`,a.style.width="100px",a.style.height="100px",e.appendChild(a),setTimeout(()=>{a.parentNode&&a.parentNode.removeChild(a)},800),copyToClipboard(n.textContent)})}function startDanmuGeneration(){spawnIntervalId&&clearInterval(spawnIntervalId);for(let e=0;e<20;e++)setTimeout(()=>createDanmu(),100*e);spawnIntervalId=setInterval(createDanmu,CONFIG.spawnInterval),autoRefreshId&&clearInterval(autoRefreshId),autoRefreshId=setInterval(refreshAllDanmu,CONFIG.refreshInterval)}function refreshAllDanmu(){document.getElementById("danmu-container").innerHTML="",danmuCount=0,initTracks(),startDanmuGeneration()}function addMultipleDanmu(){for(let e=0;e<10;e++)setTimeout(createDanmu,100*e)}function toggleFullscreen(){const e=document.getElementById("danmu-container");isFullscreen?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function handleFullscreenChange(){isFullscreen=!!document.fullscreenElement||!!document.mozFullScreenElement||!!document.webkitFullscreenElement||!!document.msFullscreenElement,document.body.classList.toggle("fullscreen",isFullscreen);const e=document.querySelector(".fullscreen-text"),t=document.querySelector(".exit-fullscreen-text");e&&t&&(isFullscreen?(e.style.display="none",t.style.display="inline"):(e.style.display="inline",t.style.display="none")),setTimeout(()=>{initTracks(),refreshAllDanmu()},100)}function toggleSettings(){const e=document.getElementById("settings-panel");(settingsOpen=!settingsOpen)?e.classList.add("active"):e.classList.remove("active")}function updateSettings(){const e=document.getElementById("density-slider"),t=document.getElementById("density-value");CONFIG.maxDanmu=parseInt(e.value),t.textContent=CONFIG.maxDanmu;const n=document.getElementById("speed-slider"),a=document.getElementById("speed-value");switch(parseInt(n.value)){case 1:CONFIG.minSpeed=15,CONFIG.maxSpeed=25,a.textContent="很慢";break;case 2:CONFIG.minSpeed=10,CONFIG.maxSpeed=20,a.textContent="慢";break;case 3:CONFIG.minSpeed=5,CONFIG.maxSpeed=15,a.textContent="中等";break;case 4:CONFIG.minSpeed=3,CONFIG.maxSpeed=10,a.textContent="快";break;case 5:CONFIG.minSpeed=2,CONFIG.maxSpeed=7,a.textContent="很快"}const o=document.getElementById("size-slider"),s=document.getElementById("size-value");switch(parseInt(o.value)){case 1:CONFIG.minFontSize=10,CONFIG.maxFontSize=16,s.textContent="很小";break;case 2:CONFIG.minFontSize=12,CONFIG.maxFontSize=20,s.textContent="小";break;case 3:CONFIG.minFontSize=14,CONFIG.maxFontSize=24,s.textContent="中等";break;case 4:CONFIG.minFontSize=18,CONFIG.maxFontSize=28,s.textContent="大";break;case 5:CONFIG.minFontSize=22,CONFIG.maxFontSize=32,s.textContent="很大"}}function setTheme(e){document.body.className=`font-sans theme-${e}`,currentTheme=e;const t=document.querySelectorAll(".theme-option");t.forEach(t=>{t.classList.remove("active"),t.dataset.theme===e&&t.classList.add("active")})}function setDanmuEffect(e){CONFIG.danmuEffect=e;const t=document.querySelectorAll("#effect-none, #effect-glow, #effect-outline, #effect-3d");t.forEach(t=>{t.classList.remove("active")});const n=document.getElementById(`effect-${e}`);n&&n.classList.add("active"),refreshAllDanmu()}async function loadSentences(){try{const e=await fetch("combined_unique.json"),t=await e.json();sentences=t.map(e=>e.content||e.text||e.sentence||JSON.stringify(e)),sentences=sentences.filter(e=>e.length<50),hideLoader(),initTracks(),startDanmuGeneration()}catch(e){console.error("加载数据失败:",e),sentences=["无法加载数据，请检查JSON文件。"],hideLoader(),initTracks(),startDanmuGeneration()}}function hideLoader(){const e=document.getElementById("loader");e.classList.add("hidden"),setTimeout(()=>{e.style.display="none"},500)}document.addEventListener("DOMContentLoaded",()=>{document.getElementById("refresh-btn").addEventListener("click",refreshAllDanmu),document.getElementById("add-btn").addEventListener("click",addMultipleDanmu),document.getElementById("settings-btn").addEventListener("click",toggleSettings),document.getElementById("fullscreen-btn").addEventListener("click",toggleFullscreen),document.addEventListener("fullscreenchange",handleFullscreenChange),document.addEventListener("mozfullscreenchange",handleFullscreenChange),document.addEventListener("webkitfullscreenchange",handleFullscreenChange),document.addEventListener("msfullscreenchange",handleFullscreenChange);const e=document.getElementById("density-slider"),t=document.getElementById("speed-slider"),n=document.getElementById("size-slider");e.addEventListener("input",updateSettings),t.addEventListener("input",updateSettings),n.addEventListener("input",updateSettings);const a=document.querySelectorAll(".theme-option");a.forEach(e=>{e.addEventListener("click",()=>{setTheme(e.dataset.theme)})}),document.getElementById("effect-none").addEventListener("click",()=>setDanmuEffect("")),document.getElementById("effect-glow").addEventListener("click",()=>setDanmuEffect("danmu-effect-glow")),document.getElementById("effect-outline").addEventListener("click",()=>setDanmuEffect("danmu-effect-outline")),document.getElementById("effect-3d").addEventListener("click",()=>setDanmuEffect("danmu-effect-3d")),loadSentences()}),window.addEventListener("resize",()=>{initTracks()});</script></body></html>
